<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Game</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/themes/dark.css" id="dark-theme" media="none">
    <script>
        // Repository configuration for GitHub issue creation
        // Update these values when deploying to GitHub Pages
        window.quizConfig = {
            repoOwner: 'a-sinclaire',  // Update this
            repoName: 'QuizGame',         // Update this if different
            gitlab: {
                url: 'https://gitlab.cee.redhat.com',
                // OAuth Application ID - PUBLIC (safe to commit to git)
                // This is NOT a secret - OAuth App IDs are meant to be public identifiers
                // Security is provided by: redirect URI validation + PKCE (no client secret needed)
                oauthAppId: '385c5844bf2fc8a93b21871ba933f468fe6a2e51b6fc2b3dd02c72b085af77c8',
                defaultRepo: 'amsincla/quiz-packs-private'  // Default repository path
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Quiz Game</h1>
            <div class="header-controls">
                <button id="theme-toggle" class="theme-btn" title="Toggle dark mode">
                    <span id="theme-icon">üåô</span>
                </button>
                <div class="sound-controls">
                    <button id="mute-btn" class="sound-btn" title="Toggle sound">
                        <span id="mute-icon">üîä</span>
                    </button>
                    <div class="volume-control">
                        <input type="range" id="volume-slider" min="0" max="100" value="50" title="Volume">
                        <span id="volume-display">50%</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Start Screen -->
        <div id="start-screen" class="screen active">
            <h2>Welcome to the Quiz!</h2>
            <div id="resume-quiz-container" class="resume-quiz-container" style="display: none;">
                <div class="resume-quiz-banner">
                    <p>üìö You have an incomplete quiz. Would you like to resume?</p>
                    <div class="resume-actions">
                        <button id="resume-quiz-btn" class="action-btn resume-btn">Resume Quiz</button>
                        <button id="dismiss-resume-btn" class="action-btn dismiss-btn">Start New Quiz</button>
                    </div>
                </div>
            </div>
            <p>Select a question pack to begin (questions will progress from easy to hard):</p>
            <div class="category-selector" id="category-selector">
                <button class="category-btn" data-category="random">Random (All Question Packs)</button>
                <button class="category-btn" data-category="test-pack">Test Pack</button>
                <!-- App-interface categories are disabled - uncomment to enable:
                <button class="category-btn" data-category="fundamentals">Fundamentals</button>
                <button class="category-btn" data-category="architecture">Architecture</button>
                <button class="category-btn" data-category="entities">Entities</button>
                <button class="category-btn" data-category="saas-files">SaaS Files</button>
                <button class="category-btn" data-category="access-control">Access Control</button>
                <button class="category-btn" data-category="integrations">Integrations</button>
                <button class="category-btn" data-category="openshift">OpenShift</button>
                <button class="category-btn" data-category="gitops">GitOps</button>
                <button class="category-btn" data-category="schemas">Schemas</button>
                <button class="category-btn" data-category="external-resources">External Resources</button>
                -->
            </div>
            
            <!-- GitLab Pack Loader -->
            <div style="display: flex; align-items: flex-start; gap: 0.5rem; margin-top: 1.5rem; flex-wrap: wrap;">
                <details id="gitlab-loader-section" class="gitlab-loader-section" style="flex: 1; min-width: 200px;">
                    <summary style="cursor: pointer; color: var(--text-secondary); font-size: 0.9rem; padding: 0.5rem; border-radius: 4px; transition: background 0.2s;">
                        üîí GitLab Authentication (for private question packs)
                    </summary>
                    <div style="margin-top: 1rem; padding: 1rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-secondary);">
                <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 1rem;">
                    Authenticate with GitLab to access private question packs from your team's repository.
                    <strong>Note:</strong> If OAuth fails due to CORS, use the Manual Token Entry method below instead.
                </p>
                    
                    <!-- OAuth Authentication -->
                    <div id="gitlab-oauth-section" style="margin-bottom: 1rem;">
                        <div id="gitlab-auth-status" style="margin-bottom: 0.75rem; padding: 0.5rem 0.75rem; border-radius: 4px; background: var(--info-bg, #d1ecf1); color: var(--info-text, #0c5460); font-size: 0.85rem; display: none;"></div>
                        <div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
                            <button id="gitlab-auth-btn" class="action-btn" style="flex: 1; min-width: 200px; padding: 0.5rem 1rem; font-size: 0.9rem;">üîê Authenticate</button>
                            <button id="gitlab-logout-btn" class="gitlab-logout-btn" style="display: none; padding: 0.4rem 0.75rem; font-size: 0.85rem; background: var(--error-bg, #f8d7da); color: var(--error-text, #721c24); border: 1px solid var(--error-color, #dc3545); border-radius: 4px; cursor: pointer; transition: all 0.2s;">Logout</button>
                        </div>
                    </div>
                    
                    <!-- Manual Token Entry (Fallback) -->
                    <details style="margin-top: 1rem;" open>
                        <summary style="cursor: pointer; color: var(--text-secondary); font-size: 0.85rem; font-weight: 500;">Manual Token Entry (Recommended if OAuth fails)</summary>
                        <div class="gitlab-config" style="margin-top: 1rem;">
                            <div style="margin-bottom: 1rem; padding: 0.75rem; background: var(--info-bg, #e7f3ff); border: 1px solid var(--info-border, #b3d9ff); border-radius: 4px;">
                                <p style="margin: 0 0 0.5rem 0; font-size: 0.85rem; color: var(--info-text, #004085);">
                                    <strong>How to create a GitLab Personal Access Token:</strong>
                                </p>
                                <ol style="margin: 0; padding-left: 1.25rem; font-size: 0.85rem; color: var(--info-text, #004085);">
                                    <li>Go to GitLab ‚Üí User Settings ‚Üí Access Tokens (or Preferences ‚Üí Access Tokens)</li>
                                    <li>Enter a token name (e.g., "Quiz Game")</li>
                                    <li>Set expiration date (optional)</li>
                                    <li>Select scopes: <code>api</code> and <code>read_repository</code></li>
                                    <li>Click "Create personal access token"</li>
                                    <li>Copy the token immediately (starts with <code>glpat-</code>)</li>
                                </ol>
                            </div>
                            <div style="margin-bottom: 1rem;">
                                <label for="gitlab-url" style="display: block; margin-bottom: 0.25rem; font-weight: 500; font-size: 0.9rem;">GitLab URL:</label>
                                <input type="text" id="gitlab-url" placeholder="https://gitlab.cee.redhat.com" value="https://gitlab.cee.redhat.com" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.9rem;">
                            </div>
                            <div style="margin-bottom: 1rem;">
                                <label for="gitlab-repo" style="display: block; margin-bottom: 0.25rem; font-weight: 500; font-size: 0.9rem;">Repository Path:</label>
                                <input type="text" id="gitlab-repo" placeholder="amsincla/quiz-packs-private" value="amsincla/quiz-packs-private" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.9rem;">
                            </div>
                            <div style="margin-bottom: 1rem;">
                                <label for="gitlab-token" style="display: block; margin-bottom: 0.25rem; font-weight: 500; font-size: 0.9rem;">Personal Access Token:</label>
                                <input type="password" id="gitlab-token" placeholder="glpat-..." style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-size: 0.9rem;">
                                <small style="display: block; margin-top: 0.25rem; color: var(--text-secondary); font-size: 0.8rem;">
                                    Token requires <code>api</code> and <code>read_repository</code> scopes. Paste your token here.
                                </small>
                            </div>
                            <div style="margin-bottom: 1rem;">
                                <label for="gitlab-packs" style="display: block; margin-bottom: 0.25rem; font-weight: 500; font-size: 0.9rem;">Pack Files (one per line):</label>
                                <textarea id="gitlab-packs" placeholder="Leave empty to auto-discover all .json files in packs/ directory&#10;&#10;Or specify pack files manually (one per line):&#10;packs/app-interface-fundamentals-v1.json&#10;packs/app-interface-architecture-v1.json" rows="5" style="width: 100%; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 4px; font-family: monospace; font-size: 0.85rem;"></textarea>
                                <small style="display: block; margin-top: 0.25rem; color: var(--text-secondary); font-size: 0.8rem;">
                                    üí° <strong>Tip:</strong> Leave empty to automatically discover and load all quiz packs from the packs/ directory. Or specify files manually for more control.
                                </small>
                            </div>
                            <button id="load-gitlab-packs-btn" class="action-btn" style="width: 100%; padding: 0.5rem; font-size: 0.9rem;">Load Internal Packs</button>
                        </div>
                    </details>
                    
                    <div id="gitlab-status" style="margin-top: 1rem; padding: 0.5rem; border-radius: 4px; display: none; font-size: 0.85rem;"></div>
                    </div>
                </details>
                
                <!-- GitLab Authentication Status Indicator (always visible) -->
                <div id="gitlab-auth-indicator" style="padding: 0.35rem 0.5rem; border-radius: 4px; background: var(--bg-secondary, #f5f5f5); border: 1px solid var(--border-color, #e0e0e0); font-size: 0.75rem; color: #1a1a1a; display: none; flex-shrink: 0; align-self: flex-start;">
                    <span id="gitlab-auth-indicator-text">üîì Not authenticated</span>
                </div>
            </div>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="screen">
            <div class="quiz-header">
                <div class="progress-info">
                    <div class="progress-top">
                        <span id="question-counter">Question 1 of 10</span>
                        <span id="difficulty-badge" class="difficulty-badge">Easy</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                </div>
                <div class="score-display">
                    <span>Score: <span id="current-score">0</span> points</span>
                </div>
            </div>

            <div class="question-container">
                <div class="question-header">
                    <h2 id="question-text">Question text will appear here</h2>
                    <button id="report-btn" class="report-btn" title="Report this question">‚ö†Ô∏è Report</button>
                </div>
                
                <div id="options-container" class="options-container">
                    <!-- Options will be dynamically inserted here -->
                </div>

                <div id="hint-container" class="hint-container">
                    <button id="hint-btn" class="hint-btn">üí° Hint</button>
                    <div id="hint-display" class="hint-display"></div>
                </div>

                <div id="feedback-container" class="feedback-container">
                    <!-- Feedback will appear here after answer selection -->
                </div>

                <button id="next-btn" class="next-btn" style="display: none;">Next Question</button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <h2>Quiz Complete!</h2>
            <div class="results-summary">
                <div class="score-highlight">
                    <p class="score-value"><span id="final-score">0</span> points</p>
                    <p class="score-details">Correct: <span id="correct-count">0</span> / <span id="total-count">0</span> (<span id="percentage">0</span>%)</p>
                </div>
                
                <div id="high-score-indicator" class="high-score-indicator" style="display: none;">
                    üèÜ New High Score!
                </div>
                
                <div class="results-breakdown">
                    <h3>Breakdown by Difficulty</h3>
                    <div class="breakdown-stats">
                        <div class="breakdown-item">
                            <span class="breakdown-label">Easy:</span>
                            <span id="easy-stats" class="breakdown-value">-</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Medium:</span>
                            <span id="medium-stats" class="breakdown-value">-</span>
                        </div>
                        <div class="breakdown-item">
                            <span class="breakdown-label">Hard:</span>
                            <span id="hard-stats" class="breakdown-value">-</span>
                        </div>
                    </div>
                </div>
                
                <div class="overall-stats" id="overall-stats" style="display: none;">
                    <h3>Your Overall Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">Total Quizzes:</span>
                            <span id="total-quizzes" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Questions:</span>
                            <span id="total-questions-stat" class="stat-value">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Overall Accuracy:</span>
                            <span id="overall-accuracy" class="stat-value">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="results-actions">
                <button id="restart-btn" class="action-btn">Take Another Quiz</button>
                <button id="review-btn" class="action-btn">Review Answers</button>
                <button id="share-btn" class="action-btn share-btn">üìã Share Results</button>
                <button id="export-reports-btn" class="action-btn export-btn">üì• Export Reports</button>
                <button id="reset-btn" class="action-btn reset-btn">Reset All Data</button>
            </div>
        </div>

        <!-- Report Modal -->
        <div id="report-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Report Question</h3>
                    <button id="close-report-modal" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="report-question-text"></p>
                    <label for="report-reason">Reason for reporting:</label>
                    <select id="report-reason" class="report-select">
                        <option value="">Select a reason...</option>
                        <option value="incorrect">Question or answer is incorrect</option>
                        <option value="unclear">Question is unclear or confusing</option>
                        <option value="explanation">Explanation is confusing or wrong</option>
                        <option value="typo">Typo or grammar error</option>
                        <option value="other">Other issue</option>
                    </select>
                    <label for="report-details">Additional details (optional):</label>
                    <textarea id="report-details" class="report-textarea" rows="4" placeholder="Please provide more information about the issue..."></textarea>
                </div>
                <div class="modal-footer">
                    <button id="cancel-report-btn" class="action-btn">Cancel</button>
                    <button id="submit-report-btn" class="action-btn">Submit Report</button>
                </div>
            </div>
        </div>

        <!-- Review Mode Screen -->
        <div id="review-screen" class="screen">
            <div class="review-header">
                <h2>Review Mode</h2>
                <div class="review-filters">
                    <select id="review-category-filter" class="filter-select">
                        <option value="">All Categories</option>
                    </select>
                    <select id="review-difficulty-filter" class="filter-select">
                        <option value="">All Difficulties</option>
                        <option value="easy">Easy</option>
                        <option value="medium">Medium</option>
                        <option value="hard">Hard</option>
                    </select>
                </div>
            </div>

            <div class="review-navigation">
                <button id="review-prev-btn" class="nav-btn">‚Üê Previous</button>
                <span id="review-question-counter">Question 1 of 6</span>
                <button id="review-next-btn" class="nav-btn">Next ‚Üí</button>
            </div>

            <div class="review-question-container">
                <div class="review-question-header">
                    <span id="review-difficulty-badge" class="difficulty-badge">Easy</span>
                    <span id="review-question-id" class="question-id"></span>
                </div>
                <h3 id="review-question-text">Question text</h3>
                
                <div id="review-options-container" class="review-options">
                    <!-- Options will be dynamically inserted -->
                </div>

                <div id="review-explanations" class="review-explanations">
                    <!-- Explanations will be shown here -->
                </div>
            </div>

            <div class="review-actions">
                <button id="review-back-btn" class="action-btn">Back to Results</button>
                <button id="review-start-btn" class="action-btn">Back to Start</button>
            </div>
        </div>
    </div>

    <script type="module" src="assets/js/main.js"></script>
</body>
</html>

